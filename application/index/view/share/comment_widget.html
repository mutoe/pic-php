
<div class="am-panel am-panel-default comment-widget">
    <div class="am-panel-hd">大家怎么说</div>
    <div class="am-panel-bd info-piece am-padding-top-0">

        <!-- 评论显示区 -->
        <div class="comments">
            {if condition="$comments"}
            {volist name="$comments" id="comm"}
            <div class="comment">
                <a class="avatar" href="__ROOT__/user/{$comm.user_id}"
                    title="{$comm.user.nickname}" style="background-image: url()"></a>
                <div class="comment-right">
                    <div class="comment-head">
                        <a class="author" href="__ROOT__/user/{$comm.user_id}">{$comm.user.nickname}</a>
                        <span class="am-text-gray am-text-xs">
                            {$comm.create_time|time_difference}前说：
                        </span>
                    </div>
                    <div class="comment-body">
                        <p class="detail">{$comm.detail}</p>
                    </div>
                </div>
            </div>
            {/volist}
            {else /}
            <div class="no-comment">
                <h3 class="am-margin-0">还没有评论</h3>
            </div>
            {/if}
        </div>

        <hr class="am-margin-top-0" />

        <!-- 评论发表组件 -->
        <form class="comment-edit">
            <div class="avatar" title="{$data.user.nickname}"
                style="background-image: url()"></div>
            <div class="comment-right">
                <textarea class="am-radius" autocomplete="off" name="detail"
                    placeholder="我说两句"></textarea>
                <small>{:auth_status('nickname')} 请勿人身攻击 遵守评论礼仪</small>
                <button type="submit" class="am-btn am-btn-xs am-btn-link am-fr">添加评论</button>
            </div>
        </form>

    </div>
</div>

<script type="text/javascript">
$('form.comment-edit').on('submit', function(event) {
    var detail = $(this).find('textarea[name="detail"]').val();
    $.post('/share/{$data.share_id}/comment', {detail: detail}, function(data) {
        console.log(data);
    });
    return false;
});

</script>
